{% include 'AppBundle:Components/Page:_page-section-action.html.twig' with {
              transDomain: 'admin'
        } %}

{% if action is defined %}
{% else %}
{% endif %}

{{ form_start(form, {attr: {novalidate: 'novalidate' }}) }}

<h1 class="form-title heading-medium-large">
    {{title}}
</h1>
  {{ form_input(form.email,'email', { 'labelClass': 'required' }) }}
  {{ form_input(form.firstname,'firstname', { 'labelClass': 'required' }) }}
  {{ form_input(form.lastname,'lastname', { 'labelClass': 'required' }) }}
  {{ form_select(form.roleId,'roleId', { 'labelClass': 'required' }) }}
  {{ form_checkbox(form.odrEnabled, 'odrEnabled', { 'labelClass': 'required' }) }}

{% include 'AppBundle:Components/ButtonBar:_start.html.twig' %}
  {{ form_submit(form.save,'submit', {'buttonClass': 'behat-link-save'}) }}
  
  {% if action is defined %}
      {% if action == 'edit' %}
             {% include 'AppBundle:Components/Link:_link-button.html.twig' with {
                    transDomain: 'admin',
                    linkButtonLabel: 'cancel.label',
                    linkClass: 'button-link',
                    linkHref: path('admin_homepage')
                    } %}
            {# only admin are allowed to delete users (except themselves when logged) #}
             {% if is_granted('ROLE_ADMIN') and app.user.id != user.id  %}
                    {% include 'AppBundle:Components/Link:_link-button.html.twig' with {
                           transDomain: 'admin',
                           linkButtonLabel: 'delete.label',
                           linkClass: 'button-link',
                           linkHref: path('admin_delete_confirm', { id: id })
                           } %}
             {% endif %}
      {% endif %}
  {% endif %}
{% include 'AppBundle:Components/ButtonBar:_end.html.twig' %}

{{ form_end(form) }}
