{% extends 'AppBundle:Layouts:application.html.twig' %}
{% set translationDomain = "report-display" %}
{% trans_default_domain translationDomain %}

{% block htmlTitle %}{{ 'page.pageSectionTitle' | trans }}{% endblock %}
{% block pageTitle %}{{ 'page.pageSectionTitle' | trans }}{% endblock %}

{% block pageContent %}
    {% if report.submitted == true %}

        {% if app.user.isDeputyPa() %}
            <nav class="back-bar">
                <a id="back-to-client" href="{{ clientProfileLink }}" class="link-return behat-link-return-to-client-profile">{{ 'page.returnToClientProfile' | trans([], 'report-submitted') }}</a>
            </nav>
        {% else %}
            <nav class="back-bar">
                <a id="back-to-client" href="{{ path('reports', {'type': report.type}) }}" class="link-return behat-link-back-to-reports">Back</a>
            </nav>
        {% endif %}
    {% endif %}

    {% if report.submitted == false %}
        {% if reportStatus.isReadyToSubmit and report.isDue %}
            {% include 'AppBundle:Components:nextprevioussimple.html.twig' with {
            'previousLink': path("report_overview" , {'reportId': report.id }),
            'previousLabel': 'Edit this report',
            'nextLink': path("report_declaration" , {'reportId': report.id }),
            'nextLabel': 'Submit report',
            'position': 'top',
            'nextAdditionalClass': 'behat-link-declaration-page'
            } %}
        {% else  %}
            {% include 'AppBundle:Components:nextprevioussimple.html.twig' with {
            'previousLink': path("report_overview" , {'reportId': report.id }),
            'previousLabel': 'Edit this report',
            'position': 'top'
            } %}
        {% endif %}
    {% endif %}
    <a name="pageBody"></a>

    <div id="page-body">
        <a class="pdflink" href="{{ path('report_pdf', {'reportId': report.id}) }}">Download as pdf</a>
        {% include 'AppBundle:Report/Formatted:formatted.html.twig' %}
    </div>

    <div id="body-footer-nav">
        {% if report.submitted == false %}
            {% if reportStatus.isReadyToSubmit and report.isDue %}
                {% include 'AppBundle:Components:nextprevioussimple.html.twig' with {
                'previousLink': path("report_overview" , {'reportId': report.id }),
                'previousLabel': 'Edit this report',
                'nextLink': path("report_declaration" , {'reportId': report.id }),
                'nextLabel': 'Submit report',
                'position': 'bottom'
                } %}
            {% else  %}
                {% include 'AppBundle:Components:nextprevioussimple.html.twig' with {
                'previousLink': path("report_overview" , {'reportId': report.id }),
                'previousLabel': 'Edit this report',
                'position': 'bottom'
                } %}
            {% endif %}
        {% endif %}
    </div>

    <script>
        $(document).ready(function() {
            var ga = new opg.Ga({'timeout': 250});
            ga.trackDownloadableLink($('.pdflink'));
        });
    </script>
{% endblock %}
