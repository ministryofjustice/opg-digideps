{% extends '@App/Layouts/application.html.twig' %}

{% import '@App/Macros/macros.html.twig' as macros %}

{% set translationDomain = "report-client-benefits-check" %}
{% trans_default_domain translationDomain %}

{% set transOptions = {
    '%client%': report.client.firstname | e,
} %}

{% block htmlTitle %}{{ 'common.htmlTitle' | trans(transOptions, translationDomain) }}{% endblock %}
{% block supportTitleTop %}{{ 'stepPage.supportTitle' | trans(transOptions, translationDomain)  }}{% endblock %}
{% block pageTitle %}{{ ('stepPage.pageTitle.' ~ step ~ '.mainTitle') | trans(transOptions, translationDomain) }}{% endblock %}



{% block supportTitleBottom %}
    {% if step != 1 %}
        {{ ('stepPage.pageTitle.'  ~ step ~ '.subTitle') | trans(transOptions, translationDomain) }}
    {% endif %}
{% endblock %}

{% block breadcrumbs %}{{ macros.breadcrumbs(report) }}{% endblock %}

{% block pageContent %}
    {{ form_start(form, { attr: {novalidate: 'novalidate' } }) }}

        {% if step == 1 %}
            {% set conditionalDateChecked %}
                {{ form_known_date(form.dateLastCheckedEntitlement, 'form.whenLastChecked', {
                    'hintText' : 'form.whenLastChecked.dateCheckedHint' | trans(transOptions, translationDomain),
                    'showDay' : 'false'
                }) }}
            {% endset %}

            {% set conditionalNeverChecked %}
                {{ form_input(form.neverCheckedExplanation, 'form.whenLastChecked', {
                    'hintText' : 'form.whenLastChecked.neverCheckedHint' | trans(transOptions, translationDomain),
                    'label' : { 'text': '' }
                }) }}
            {% endset %}

            {{ form_checkbox_group(form.whenLastCheckedEntitlement, 'form.clientBenefitsCheck', {
                'useFormGroup': false,
                'labelText': ('form.clientBenefitsCheck.label') | trans(transOptions, translationDomain),
                label: {
                    isPageHeading: true,
                    caption: 'stepPage.supportTitle' | trans
                },
                'items': [
                    {
                        conditional: conditionalDateChecked
                    },
                    {},
                    {
                        conditional: conditionalNeverChecked
                    }
                ]
            }) }}

            {{ macros.saveAndContinueButton(form.save) }}
        {% endif %}

    {% if step == 2 %}
        {% set conditionalIncomeDontKnowChecked %}
            {{ form_input(form.doOthersReceiveIncomeOnClientsBehalf, 'form.incomeOnClientsBehalf', {
                'hintText' : 'form.incomeOnClientsBehalf.dontKnowHint' | trans(transOptions, translationDomain),
                'label' : { 'text': 'form.incomeOnClientsBehalf.dontKnowLabel' | trans(transOptions, translationDomain) }
            }) }}
        {% endset %}

        {{ form_checkbox_group(form.doOthersReceiveIncomeOnClientsBehalf, 'form.incomeOnClientsBehalf', {
            'useFormGroup': false,
            'labelText': ('form.clientBenefitsCheck.label') | trans(transOptions, translationDomain),
            label: {
                isPageHeading: true,
                caption: 'stepPage.supportTitle' | trans
            },
            'items': [
                {},
                {},
                {
                    conditional: conditionalIncomeDontKnowChecked
                }
            ]
        }) }}

        {{ macros.saveAndContinueButton(form.save) }}
    {% endif %}

    {% if step == 3 %}
        {% for typeOfIncomeReceivedOnClientsBehalf in form.typesOfIncomeReceivedOnClientsBehalf %}
            {{ form_input(typeOfIncomeReceivedOnClientsBehalf.incomeType, '', {
                'hintText' : '',
                'label' : { 'text': 'form.incomeDetails.incomeTypeLabel' | trans(transOptions, translationDomain) }
            }) }}

            {{ form_input(typeOfIncomeReceivedOnClientsBehalf.amount, '', {
                'hintText' : '',
                'label' : { 'text': 'form.incomeDetails.amountLabel' | trans(transOptions, translationDomain) },
                'inputPrefix' : 'Â£'
            }) }}


        {% endfor %}

        {{ macros.saveAndContinueButton(form.save) }}
        {{ macros.addAnotherSaveButton(form.addAnother, 'addAnother') }}
    {% endif %}

    {{ form_end(form) }}

{% endblock %}
