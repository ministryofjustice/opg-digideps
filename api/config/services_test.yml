services:
    App\Service\BruteForce\AttemptsInTimeChecker:
        arguments: [ "@snc_redis.default" ]
        calls:
            - [ setRedisPrefix, ["test_ac_ret_code"] ]
            # after 5 attempts in the last 10 minutes, return a different return code (activate captcha)
            - [ addTrigger, [  5, 600 ] ]
    App\Service\BruteForce\AttemptsIncrementalWaitingChecker:
        arguments: [ "@snc_redis.default" ]
        calls:
            - [ setRedisPrefix, ["test_ac_exception"] ]
            # after 10 attempts, freeze for 10 minutes. used by AuthControllerTest::testBruteForceSameEmail
            - [ addFreezingRule, [  10, 600 ] ]