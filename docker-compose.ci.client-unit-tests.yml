version: "3.2"
services:
  # Client Unit Test Requirements
  client-unit-tests:
    container_name: client-unit-tests-app
    image: frontend-unit-tests:latest
    build:
      context: ./client
    depends_on:
      - pact-mock
    environment:
      APP_ENV: ${APP_ENV:-dev}
      APP_DEBUG: ${APP_DEBUG:-0}
      AWS_ACCESS_KEY_ID: aFakeSecretAccessKeyId
      AWS_SECRET_ACCESS_KEY: aFakeSecretAccessKey
      AWS_SESSION_TOKEN: fakeValue
    env_file:
      - ./client/frontend.env
  pact-mock:
    image: pactfoundation/pact-cli:0.51.0.4
    ports:
      - 1234:80
    command:
      - mock-service
      - -p
      - "80"
      - --host
      - "0.0.0.0"
      - --pact-dir
      - /tmp/pacts
      - --consumer
      - Complete the deputy report
      - --provider
      - OPG Data
